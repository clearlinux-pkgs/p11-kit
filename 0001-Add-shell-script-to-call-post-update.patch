From 3e6f8517e77e8cab4913c54fe36b028a9dc648f2 Mon Sep 17 00:00:00 2001
From: Michael Leibowitz <michael.leibowitz@intel.com>
Date: Wed, 15 Jun 2016 00:11:23 +0000
Subject: [PATCH] Add shell script to call post-update

post-update trigger

Signed-off-by: Michael Leibowitz <michael.leibowitz@intel.com>
---
 trust-certs | 23 +++++++++++++++++++++++
 1 file changed, 23 insertions(+)
 create mode 100755 trust-certs

diff --git a/trust-certs b/trust-certs
new file mode 100755
index 0000000..d793018
--- /dev/null
+++ b/trust-certs
@@ -0,0 +1,23 @@
+#!/bin/bash
+
+if [ ! -d /var/cache/ca-certs ]
+then
+    mkdir -p /var/cache/ca-certs
+    mkdir -p /var/cache/ca-certs/extracted
+    mkdir -p /var/cache/ca-certs/extracted/java
+    mkdir -p /var/cache/ca-certs/extracted/openssl
+    mkdir -p /var/cache/ca-certs/extracted/pem
+fi
+
+find /var/cache/ca-certs/ -type f -delete
+find /usr/share/ca-certs/cache -type f -name \*.p11-kit -exec cp {} /var/cache/ca-certs \;
+
+if [ -e /etc/ssl/custom_certs ]
+then
+  find /etc/ssl/custom_certs -type f -exec trust anchor {} \;
+fi
+
+update-ca-trust
+#ubuntu compat
+ln -s /var/cache/ca-certs/extracted/openssl/ca-bundle.trust.pem /var/cache/ca-certs/ca-certificates.crt
+
-- 
2.9.0

